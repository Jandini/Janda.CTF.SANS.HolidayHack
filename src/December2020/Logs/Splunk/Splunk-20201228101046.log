2020-12-28 10:10:46.150 +00:00 [VRB] Started SANS Holiday Hack, December 2020
2020-12-28 10:10:46.168 +00:00 [VRB] Using CTF runner 0.1.0-alpha.19
2020-12-28 10:10:46.170 +00:00 [VRB] Running challange Splunk
2020-12-28 10:10:46.171 +00:00 [INF] Splunk url taken from java script page... before becomming Santa
https://splunk.kringlecastle.com/en-US/account/insecurelogin?username=santa&password=2f3a4fccca6406e35bcf33e92dd93135
2020-12-28 10:10:46.172 +00:00 [INF] Random searches

                | tstats count where index=* by index
                | metadata index=attack type=hosts

                index=attack

                index=attack | fields Technique | uniq

                index= * | mitremap

                | tstats values(sourcetypes) where index=*

                index=* sourcetype=wineventlog



                | metadata type=sourcetypes index=*

            
2020-12-28 10:10:46.173 +00:00 [INF] | metadata type=sourcetypes index=*

	                firstTime	lastTime	recentTime	sourcetype	totalCount	type
                1	1606762640	1606770257	1606770258	WinEventLog	10283	sourcetypes
                2	1606762873	1606769955	1606770075	wineventlog	220669	sourcetypes
                3	1606762638	1606770232	1606770234	xmlwineventlog	42499	sourcetypes
                4	1606758856	1606770255	1606770259	bro:conn:json	13921	sourcetypes
                5	1606762029	1606769631	1606769631	bro:dns:json	44	sourcetypes
                6	1606761928	1606770250	1606770252	bro:files:json	5812	sourcetypes
                7	1606762801	1606770250	1606770252	bro:http:json	2597	sourcetypes
                8	1606761921	1606770230	1606770236	bro:rdp:json	2363	sourcetypes
                9	1606763121	1606769601	1606769602	bro:smb_files:json	2	sourcetypes
                10	1606763121	1606769635	1606769635	bro:smb_mapping:json	8	sourcetypes
                11	1606769219	1606769219	1606769479	bro:software:json	1	sourcetypes
                12	1606761926	1606770230	1606770230	bro:ssl:json	2725	sourcetypes
                13	1606761927	1606770230	1606770230	bro:x509:json	2722	sourcetypes
                14	1606754786	1606769951	1606770027	csv	68	sourcetypes

            
2020-12-28 10:10:46.174 +00:00 [INF] | tstats count where index=* by index

	                index	count
                1	attack	68
                2	t1033-main	3311
                3	t1033-win	21734
                4	t1057-win	18006
                5	t1059.003-main	1984
                6	t1059.003-win	18519
                7	t1059.005-main	1758
                8	t1059.005-win	18852
                9	t1071.001-main	2795
                10	t1071.001-win	20718
                11	t1082-win	18136
                12	t1105-main	1938
                13	t1105-win	15424
                14	t1106-main	1611
                15	t1106-win	18720
                16	t1123-main	4281
                17	t1123-win	20488
                18	t1204.002-main	1342
                19	t1204.002-win	20033
                20	t1547.001-main	1833
                21	t1547.001-win	19490
                22	t1548.002-main	7018
                23	t1548.002-win	21499
                24	t1559.002-main	2324
                25	t1559.002-win	22144
                26	t1566.001-win	19688
            
2020-12-28 10:10:46.175 +00:00 [INF] How many distinct MITRE ATT & CK techniques did Alice emulate? 13

                t1033,t1057,t1059,t1071,t1082,t1105,t1106,t1123,t1204,t1547,t1548,t1559,t1566
            
2020-12-28 10:10:46.177 +00:00 [INF] What are the names of the two indexes that contain the results of emulating Enterprise ATT&CK technique 1059.003 ? (Put them in alphabetical order and separate them with a space) t1059.003-main t1059.003-win

                t1059.003-main t1059.003-win
            
2020-12-28 10:10:46.178 +00:00 [INF] One technique that Santa had us simulate deals with 'system information discovery'. What is the full name of the registry key that is queried to determine the MachineGuid? HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography

                https://attack.mitre.org/techniques/T1082/
                https://atomicredteam.io/
                https://github.com/redcanaryco/atomic-red-team/tree/master/atomics 

                From: 

                https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md

                Atomic Test #8 - Windows MachineGUID Discovery
                Identify the Windows MachineGUID value for a system. Upon execution, the machine GUID will be displayed from registry.

                Supported Platforms: Windows

                Attack Commands: Run with command_prompt!
                REG QUERY HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography /v MachineGuid

            
2020-12-28 10:10:46.180 +00:00 [VRB] Challenge Splunk completed
